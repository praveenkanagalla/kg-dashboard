<form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="create-new-user">
    <h2>Create New User</h2>

    <label>Name</label>
    <input formControlName="name" type="text" />

    <label>Email</label>
    <input formControlName="email" type="email" />

    <label>Password</label>
    <input formControlName="password" type="password" />

    <label>Phone</label>
    <input formControlName="phone" type="text" />

    <label>Role:</label>
    <select formControlName="role" required>
        <option value="" disabled>Select Role</option>
        <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
    </select>

    <!-- New Blood Group field -->
    <label>Blood Group</label>
    <select formControlName="blood_group" required>
        <option value="" disabled>Select Blood Group</option>
        <option value="A+">A+</option>
        <option value="A-">A-</option>
        <option value="B+">B+</option>
        <option value="B-">B-</option>
        <option value="O+">O+</option>
        <option value="O-">O-</option>
        <option value="AB+">AB+</option>
        <option value="AB-">AB-</option>
    </select>

    <!-- New Address field -->
    <label>Address</label>
    <textarea formControlName="address" rows="3"></textarea>

    <label>Access Permissions</label>
    <div class="dropdown-checkbox">
        <div class="dropdown-header" (click)="toggleDropdown()">
            {{ selectedPermissionsLabel() }}
            <span class="arrow">&#9662;</span>
        </div>

        <div class="dropdown-list" *ngIf="dropdownOpen">
            <!-- Loop over filtered permissionsList -->
            <label *ngFor="let perm of permissionsList">
                <input type="checkbox" [value]="perm.route"
                    [checked]="(userForm.get('permissions')?.value || []).includes(perm.route)"
                    (change)="onAccessChange($event)" />
                {{ perm.name }}
            </label>
        </div>
    </div>

    <button type="submit" [disabled]="userForm.invalid">Create User</button>
</form>